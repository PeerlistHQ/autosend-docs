{
  "openapi": "3.1.0",
  "info": {
    "title": "AutoSend API",
    "description": "AutoSend REST API for managing contacts and sending emails",
    "version": "1.0.0"
  },
  "servers": [
    {
      "url": "https:/api.autosend.com/v1"
    }
  ],
  "security": [
    {
      "bearerAuth": []
    }
  ],
  "paths": {
    "/contacts": {
      "post": {
        "summary": "Create Contact",
        "description": "Creates a new contact in your AutoSend project. If a contact with the same email already exists, this endpoint will return an error. Use the Upsert Contact endpoint if you want to update existing contacts.",
        "tags": ["Contacts"],
        "requestBody": {
          "description": "Contact information to create",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateContactRequest"
              },
              "examples": {
                "example1": {
                  "summary": "Create contact with all fields",
                  "value": {
                    "email": "john.doe@example.com",
                    "firstName": "John",
                    "lastName": "Doe",
                    "userId": "user_12345",
                    "customFields": {
                      "company": "Acme Corp",
                      "role": "Developer",
                      "plan": "premium"
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Contact created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateContactResponse"
                },
                "example": {
                  "success": true,
                  "data": {
                    "id": "507f1f77bcf86cd799439011",
                    "email": "john.doe@example.com",
                    "firstName": "John",
                    "lastName": "Doe",
                    "userId": "user_12345",
                    "customFields": {
                      "company": "Acme Corp",
                      "role": "Developer",
                      "plan": "premium"
                    },
                    "updatedAt": "2024-01-15T10:30:00.000Z",
                    "createdAt": "2024-01-15T10:30:00.000Z",
                    "projectId": "229f1f77bcf86cd9273048038"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/contacts/email": {
      "post": {
        "summary": "Upsert Contact",
        "description": "Creates a new contact or updates an existing contact if the email already exists. This is the recommended endpoint for most contact synchronization scenarios.",
        "tags": ["Contacts"],
        "requestBody": {
          "description": "Contact information to create or update",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateContactRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Contact created or updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ContactResponse"
                },
                "example": {
                  "success": true,
                  "data": {
                    "id": "507f1f77bcf86cd799439011",
                    "email": "john.doe@example.com",
                    "firstName": "John",
                    "lastName": "Doe",
                    "userId": "user_12345",
                    "customFields": {
                      "company": "Acme Corp",
                      "role": "Developer",
                      "plan": "premium"
                    },
                    "updatedAt": "2024-01-15T10:30:00.000Z",
                    "createdAt": "2024-01-15T10:30:00.000Z",
                    "projectId": "229f1f77bcf86cd9273048038"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/contacts/{id}": {
      "get": {
        "summary": "Get Contact by ID",
        "description": "Retrieves a single contact by its unique identifier.",
        "tags": ["Contacts"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Unique contact ID",
            "required": true,
            "schema": {
              "type": "string",
              "pattern": "^[0-9a-fA-F]{24}$"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Contact retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ContactResponse"
                },
                "example": {
                  "success": true,
                  "data": {
                    "id": "507f1f77bcf86cd799439011",
                    "email": "john.doe@example.com",
                    "firstName": "John",
                    "lastName": "Doe",
                    "userId": "user_12345",
                    "customFields": {
                      "company": "Acme Corp",
                      "role": "Developer",
                      "plan": "premium"
                    },
                    "updatedAt": "2024-01-15T10:30:00.000Z",
                    "createdAt": "2024-01-15T10:30:00.000Z",
                    "projectId": "229f1f77bcf86cd9273048038"
                  }
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete Contact by Id",
        "description": "Deletes a contact by its id.",
        "tags": ["Contacts"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Single contact id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Contact deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeleteContactResponse"
                }
              }
            }
          }
        }
      }
    },
    "/contacts/search/emails": {
      "post": {
        "summary": "Search Contacts by Emails",
        "description": "Searches for multiple contacts by their email addresses in a single request. Returns all matching contacts found in your project.",
        "tags": ["Contacts"],
        "requestBody": {
          "description": "Array of email addresses to search",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SearchContactsRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Contacts retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SearchContactsResponse"
                },
                "example": {
                  "success": true,
                  "data": {
                  "contacts": [
                    {
                      "id": "507f1f77bcf86cd799439011",
                      "email": "john.doe@example.com",
                      "firstName": "John",
                      "lastName": "Doe",
                      "userId": "user_12345",
                      "customFields": {
                        "company": "Acme Corp",
                        "role": "Developer",
                        "plan": "premium"
                      },
                      "updatedAt": "2024-01-15T10:30:00.000Z",
                      "createdAt": "2024-01-15T10:30:00.000Z",
                      "projectId": "229f1f77bcf86cd9273048038"
                    }
                  ]  
                }
                }
              }
            }
          }
        }
      }
    },
    "/contacts/email/duplicate": {
      "post": {
        "summary": "Duplicate Contact",
        "description": "Creates a duplicate of an existing contact with a new email address. Copies all data from the source contact including custom fields, tags, and other attributes.",
        "tags": ["Contacts"],
        "requestBody": {
          "description": "Source and new email addresses",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DuplicateContactRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Contact duplicated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DuplicateContactResponse"
                }
              }
            }
          }
        }
      }
    },
    "/contacts/email/{email}/custom-fields": {
      "patch": {
        "summary": "Update Custom Fields",
        "description": "Updates or adds custom fields for a contact identified by email address. Custom fields are merged - new fields are added, existing fields are updated, and fields not mentioned remain unchanged.",
        "tags": ["Contacts"],
        "parameters": [
          {
            "name": "email",
            "in": "path",
            "description": "Email address of the contact (URL encoded, automatically normalized)",
            "required": true,
            "schema": {
              "type": "string",
              "format": "email"
            }
          }
        ],
        "requestBody": {
          "description": "Custom fields to update or add",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "additionalProperties": true
              },
              "example": {
                "lastPurchase": "2024-01-20",
                "totalSpent": 499.99,
                "loyaltyTier": "gold"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Custom fields updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ContactResponse"
                }
              }
            }
          }
        }
      }
    },
    "/contacts/email/userId/{userId}": {
      "delete": {
        "summary": "Delete Contact by User ID",
        "description": "Permanently deletes a contact identified by the userId field (your application's user identifier).",
        "tags": ["Contacts"],
        "parameters": [
          {
            "name": "userId",
            "in": "path",
            "description": "Your application's user identifier",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Contact deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    }
                  }
                },
                "example": {
                  "success": true
                }
              }
            }
          }
        }
      }
    },
    "/contacts/bulk-update": {
      "post": {
        "summary": "Bulk Update Contacts",
        "description": "Updates or creates multiple contacts in a single API request. Each contact is either created (if it doesn't exist) or updated (if it does) based on the email address. Maximum limit: 100 contacts per request.",
        "tags": ["Contacts"],
        "requestBody": {
          "description": "Array of contacts to update or create",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BulkUpdateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Bulk update completed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkUpdateResponse"
                },
                "example": {
                  "success": true,
                  "data": {
                    "successCount": 1, 
                    "failedCount": 0, 
                    "totalCount": 1
                  }
                }
              }
            }
          }
        }
      }
    },
    "/contacts/remove": {
      "post": {
        "summary": "Remove Contacts by Emails",
        "description": "Removes one or more contacts by their email addresses. Returns the IDs of the contacts that were successfully removed.",
        "tags": ["Contacts"],
        "requestBody": {
          "description": "Array of email addresses to remove",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RemoveContactsRequest"
              },
              "example": {
                "emails": ["email1@gmail.com"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Contacts removed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RemoveContactsResponse"
                }
              }
            }
          }
        }
      }
    },
    "/contacts/{id}/unsubscribe-groups": {
      "get": {
        "summary": "Get Contact's Unsubscribe Groups",
        "description": "Returns an array of unsubscribe group",
        "tags": ["Contacts"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Unique id of the contact",
            "required": true,
            "schema": {
              "type": "string",
              "pattern": "^[0-9a-fA-F]{24}$"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Unsubscribe groups retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UnsubscribeGroupsResponse"
                },
                "example": {
                  "success": true,
                  "data": {
                    "groups": [
                      {
                        "groupId": "20XWO",
                        "name": "Our blog"
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      }
    }   
  },
  
  "components": {
    "schemas": {
      
      "CreateContactRequest": {
        "type": "object",
        "required": ["email"],
        "properties": {
          "email": {
            "type": "string",
            "format": "email",
            "description": "Valid email address (automatically normalized to lowercase)",
            "example": "john.doe@example.com"
          },
          "firstName": {
            "type": "string",
            "description": "Contact's first name",
            "example": "John"
          },
          "lastName": {
            "type": "string",
            "description": "Contact's last name",
            "example": "Doe"
          },
          "userId": {
            "type": "string",
            "description": "Your application's user identifier",
            "example": "user_12345"
          },
          "customFields": {
            "type": "object",
            "description": "Key-value pairs for custom contact attributes",
            "additionalProperties": {
              "type": "string"
            },
            "example": {
              "company": "Acme Corp",
              "role": "Developer",
              "plan": "premium"
            }
          }
        }
      },
      "Contact": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Contact ID",
            "example": "507f1f77bcf86cd799439011"
          },
          "email": {
            "type": "string",
            "format": "email",
            "description": "Contact email address",
            "example": "john.doe@example.com"
          },
          "firstName": {
            "type": "string",
            "description": "Contact's first name",
            "example": "John"
          },
          "lastName": {
            "type": "string",
            "description": "Contact's last name",
            "example": "Doe"
          },
          "userId": {
            "type": "string",
            "description": "You can store userId used in your application",
            "example": "user_12345"
          },
          "customFields": {
            "type": "object",
            "description": "Custom contact attributes",
            "additionalProperties": {
              "type": "string"
            },
            "example": {
              "company": "Acme Corp",
              "role": "Developer",
              "plan": "premium"
            }
          },
          "createdAt": {
            "type": "string",
            "format": "date-time",
            "description": "Contact creation timestamp",
            "example": "2024-01-15T10:30:00.000Z"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time",
            "description": "Contact last update timestamp",
            "example": "2024-01-15T10:30:00.000Z"
          },
          "projectId": {
            "type": "string",
            "description": "Project ID that the contact belongs to",
            "example": "229f1f77bcf86cd9273048038"
          }
        }
      },
      "CreateContactResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Indicates if the request was successful",
            "example": true
          },
          "data": {
            "$ref": "#/components/schemas/Contact"
          }
        }
      },
      "ErrorResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Indicates if the request was successful",
            "example": false
          },
          "message": {
            "type": "string",
            "description": "Error message",
            "example": "Invalid email format or missing required fields"
          }
        }
      },
      "ContactResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Indicates if the request was successful",
            "example": true
          },
          "data": {
            "$ref": "#/components/schemas/Contact"
          }
        }
      },
      "SearchContactsRequest": {
        "type": "object",
        "required": ["emails"],
        "properties": {
          "emails": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "email"
            },
            "description": "Array of email addresses (minimum 1, automatically normalized)",
            "minItems": 1,
            "example": ["john.doe@example.com", "jane.smith@example.com"]
          }
        }
      },
      "SearchContactsResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": true
          },
          "data": {
            "type": "object",
            "properties": {
              "contacts": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Contact"
                }
              }
            }
          }
        }
      },
      "DuplicateContactRequest": {
        "type": "object",
        "required": ["sourceEmail", "newEmail"],
        "properties": {
          "sourceEmail": {
            "type": "string",
            "format": "email",
            "description": "Email of the existing contact to duplicate",
            "example": "old-email@example.com"
          },
          "newEmail": {
            "type": "string",
            "format": "email",
            "description": "Email address for the new duplicated contact",
            "example": "new-email@example.com"
          }
        }
      },
      "DuplicateContactResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": true
          },
          "data": {
            "type": "object",
            "properties": {
              "sourceContact": {
                "$ref": "#/components/schemas/Contact"
              },
              "newContact": {
                "$ref": "#/components/schemas/Contact"
              }
            }
          }
        }
      },
      "BulkUpdateRequest": {
        "type": "object",
        "required": ["contacts"],
        "properties": {
          "contacts": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CreateContactRequest"
            },
            "description": "Array of contact objects (minimum 1, maximum 100)",
            "minItems": 1,
            "maxItems": 100
          },
          "runWorkflow": {
            "type": "boolean",
            "description": "Whether to trigger workflows for updated contacts",
            "default": false,
            "example": false
          }
        }
      },
      "BulkUpdateResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": true
          },
          "data": {
            "type": "object",
            "properties": {
              "successCount": {
                "type": "integer",
                "description": "Number of successfully updated/created contacts",
                "example": 1
              },
              "failedCount": {
                "type": "integer",
                "description": "Number of failed contacts",
                "example": 0
              },
              "totalCount": {
                "type": "integer",
                "description": "Total number of contacts processed",
                "example": 1
              }
            }
          }
        }
      },
      "BulkUpdateResult": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": true
          },
          "email": {
            "type": "string",
            "format": "email",
            "example": "user1@example.com"
          },
          "contact": {
            "$ref": "#/components/schemas/Contact"
          },
          "error": {
            "type": "string",
            "description": "Error message if success is false",
            "example": "Invalid email format"
          }
        }
      },
      "DeleteContactResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": true
          }
        }
      },
      "RemoveContactsRequest": {
        "type": "object",
        "required": ["emails"],
        "properties": {
          "emails": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "email"
            },
            "description": "Array of email addresses to remove (minimum 1, automatically normalized)",
            "minItems": 1,
            "example": ["email1@gmail.com"]
          }
        }
      },
      "RemoveContactsResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": true
          }
        }
      },
      "UnsubscribeGroupsResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": true
          },
          "data": {
            "type": "object",
            "properties": {
              "groups": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "groupId": {
                      "type": "string",
                      "example": "20XWO"
                    },
                    "name": {
                      "type": "string",
                      "example": "Our blog"
                    }
                  }
                },
                "description": "Array of unsubscribe groups with groupId and name"
              }
            }
          }
        }
      }
      
    },
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer"
      }
    }
  }
}
